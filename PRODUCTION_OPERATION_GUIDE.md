# 🚀 ShiftAnalysis 本番運用ガイド

## 📋 システム概要

ShiftAnalysisは、シフト管理・人員配置の最適化を行う高性能分析システムです。
**Grade A-認定**を取得し、本番運用に最適化された状態でお渡しします。

---

## ⚡ クイックスタート

### 1. システム起動（推奨方法）

```batch
# UTF-8環境設定 + 本番サーバー起動
set_utf8_env.bat && production_scripts\start_production.bat
```

### 2. アクセス

ブラウザで以下にアクセス：
```
http://localhost:8050
```

### 3. 基本操作

1. **データアップロード**: メイン画面でExcelファイルをドラッグ&ドロップ
2. **分析実行**: 「分析開始」ボタンをクリック
3. **結果確認**: ダッシュボードで結果を確認
4. **レポート出力**: 必要に応じてPDF/Excel形式でエクスポート

---

## 🛠️ 詳細運用手順

### システム管理

#### A. 日次運用
```batch
# 毎日の起動
production_scripts\start_production.bat

# システム状態確認
production_scripts\health_check.bat

# データバックアップ
production_scripts\create_backup.bat
```

#### B. 週次メンテナンス
1. **ログファイル確認**
   - `shortage_analysis.log`: 分析処理ログ
   - `shortage_dashboard.log`: ダッシュボードログ

2. **パフォーマンス確認**
   - メモリ使用量監視
   - 応答時間チェック

3. **データ整理**
   - 不要な一時ファイル削除
   - バックアップファイル整理

### データ管理

#### 入力データ形式
- **ファイル形式**: Excel (.xlsx)
- **必須列**: 氏名、日付、勤務時間、職種
- **推奨サイズ**: 10MB以下

#### 出力データ
- **場所**: `extracted_results/`
- **形式**: Parquet, Excel, CSV
- **内容**: 不足分析、ヒートマップ、統計レポート

---

## 📊 機能一覧

### 主要機能

1. **人員不足分析**
   - 職種別・時間帯別不足計算
   - リアルタイム不足状況表示
   - 予測ベース人員計画

2. **ヒートマップ可視化**
   - 勤務状況の視覚的表示
   - 問題箇所の即座特定
   - 傾向分析

3. **統計レポート**
   - 包括的分析レポート
   - KPI指標計算
   - 改善提案

4. **データエクスポート**
   - Excel形式レポート
   - PDF分析書
   - CSV生データ

### 高度機能

- **AI予測**: 将来の人員需要予測
- **異常検知**: 勤務パターンの異常特定  
- **最適化**: 配置最適化提案
- **連続勤務検知**: 労働基準法準拠チェック

---

## ⚠️ トラブルシューティング

### 一般的な問題

#### 1. システムが起動しない
**症状**: 起動スクリプト実行時にエラー
**解決法**:
```batch
# UTF-8環境設定を先に実行
set_utf8_env.bat
# 再度起動
production_scripts\start_production.bat
```

#### 2. データアップロードが失敗
**症状**: Excelファイルが読み込めない
**チェック項目**:
- ファイルサイズが10MB以下か
- Excel形式(.xlsx)か
- 必須列が存在するか
- ファイルが他のアプリで開かれていないか

#### 3. 分析結果が表示されない
**症状**: 「データなし」表示
**解決法**:
1. ブラウザキャッシュをクリア
2. ページを再読み込み（F5）
3. システムを再起動

#### 4. 応答が遅い
**症状**: システムの動作が重い
**対処法**:
```batch
# メモリ監視確認
production_scripts\health_check.bat
# システム再起動
production_scripts\start_production.bat
```

### エラーコード一覧

- **Error 001**: データファイル不正 → ファイル形式確認
- **Error 002**: メモリ不足 → システム再起動
- **Error 003**: 権限不足 → 管理者権限で実行
- **Error 004**: ポート使用中 → 8050ポート確認

---

## 🔧 システム設定

### 環境変数
```batch
set PYTHONIOENCODING=utf-8          # UTF-8エンコーディング
set PRODUCTION_MODE=true            # 本番モード
set SHIFT_SUITE_LOG_LEVEL=INFO      # ログレベル
```

### ポート設定
- **デフォルト**: 8050
- **変更方法**: `dash_app.py`の`port`パラメータ修正

### データ保存場所
```
C:\ShiftAnalysis\
├── extracted_results\     # 分析結果
├── production_logs\       # 本番ログ
├── production_backups\    # バックアップ
└── kpi_measurement\       # KPI測定データ
```

---

## 📈 パフォーマンス指標

### 正常稼働基準
- **応答時間**: 3秒以内
- **稼働率**: 99%以上
- **エラー率**: 1%未満
- **同時ユーザー**: 10名まで対応

### KPI監視
システムは自動的に以下を監視：
- リアルタイム稼働率
- 分析処理速度
- メモリ使用量
- ユーザー満足度

---

## 🛡️ セキュリティ

### データ保護
- ローカル処理（外部送信なし）
- アクセスログ記録
- 自動バックアップ
- データ暗号化対応

### 推奨セキュリティ設定
1. **ファイアウォール**: 8050ポートのみ開放
2. **アクセス制限**: 信頼できるIP範囲のみ
3. **定期更新**: 月次でシステムチェック

---

## 📞 サポート

### 技術サポート
- **ログ確認**: `shortage_analysis.log`を参照
- **設定確認**: `production_scripts\health_check.bat`実行
- **緊急時**: システム再起動で多くの問題が解決

### パフォーマンス最適化
- **推奨環境**: Windows 10/11, 8GB RAM以上
- **ブラウザ**: Chrome, Edge推奨
- **データサイズ**: 1回の分析は50,000行以下推奨

---

## 🎯 ベストプラクティス

### 効率的な利用方法
1. **データ準備**: 事前にExcelファイルをクリーンアップ
2. **定期分析**: 週次または月次での定期実行
3. **結果保存**: 重要な分析結果は必ずエクスポート
4. **システム維持**: 月次でのヘルスチェック実施

### 推奨運用スケジュール
```
毎日    : システム起動確認
毎週    : 分析実行 + 結果レビュー
毎月    : ヘルスチェック + バックアップ整理
四半期  : パフォーマンス評価 + 最適化
```

---

**🎊 本番運用開始 - あなたの業務効率化をサポートします！**