
# 🎯 根本的休日除外テスト手順

## 1. 準備
- `ショート_テスト用データ.xlsx` が存在することを確認
- `app.py` を起動: `python app.py` または `streamlit run app.py`

## 2. テスト実行
1. ブラウザでlocalhost:8501にアクセス
2. 「ショート_テスト用データ.xlsx」をアップロード
3. シート選択で適切なシート（例：R7.6）を選択
4. **「Run Analysis」ボタンをクリック**

## 3. 確認ポイント

### A. ログメッセージ確認（ターミナル）
```
[RestExclusion] 休日・休暇レコードを除外: XX件 (YY.Y%)
[RestExclusion] 総除外結果: AAAA -> BBBB (除外: CC件, DD.D%)
```

### B. ヒートマップ確認
- 「ヒートマップ分析」タブを開く
- 休日（土日や「×」マークの時間帯）に人数が表示されていない
- 実際に勤務している時間帯のみに数値が表示される

### C. 不足分析確認
- 「不足分析」タブを開く
- より正確な不足時間が表示される（以前より少ない値）
- 休日が分析に含まれていない

## 4. 成功判定
✅ ログに「[RestExclusion]」メッセージが表示される
✅ ヒートマップに休日データが表示されない
✅ 不足分析の値が合理的な範囲内
✅ 「実際に働いている人たちの状況が可視化」されている

## 5. 失敗時の対応
❌ ログメッセージが表示されない → io_excel.pyの修正を再確認
❌ 依然として休日が表示される → 修正内容を詳細確認
❌ エラーが発生 → エラーメッセージをチェック

この手順で、ユーザーが指摘した
「休みがカウントされている現状が改善されていません。シフトデータで言う「×」です」
という問題が根本的に解決されるはずです。
